{"version":3,"sources":["../../../../src/commands/info/config/configAsync.ts"],"names":["actionAsync","projectRoot","options","config","type","getPrebuildConfigAsync","platforms","exp","introspect","assertMissingModProviders","modRequest","modResults","getConfig","skipSDKVersionRequirement","isPublicConfig","CommandError","configOutput","full","json","Log","log","nested","JSON","stringify"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAQO,eAAeA,WAAf,CAA2BC,WAA3B,EAAgDC,OAAhD,EAAkE;AACvE,MAAIC,MAAJ;;AAEA,MAAID,OAAO,CAACE,IAAR,KAAiB,UAArB,EAAiC;AAC/BD,IAAAA,MAAM,GAAG,MAAM,oCAAcE,wCAAd,EAAsCJ,WAAtC,EAAmD;AAChEK,MAAAA,SAAS,EAAE,CAAC,KAAD,EAAQ,SAAR;AADqD,KAAnD,CAAf;AAGD,GAJD,MAIO,IAAIJ,OAAO,CAACE,IAAR,KAAiB,YAArB,EAAmC;AACxCD,IAAAA,MAAM,GAAG,MAAM,oCAAcE,wCAAd,EAAsCJ,WAAtC,EAAmD;AAChEK,MAAAA,SAAS,EAAE,CAAC,KAAD,EAAQ,SAAR;AADqD,KAAnD,CAAf;AAIA,UAAM,qCAAiBH,MAAM,CAACI,GAAxB,EAA6B;AACjCN,MAAAA,WADiC;AAEjCO,MAAAA,UAAU,EAAE,IAFqB;AAGjCF,MAAAA,SAAS,EAAE,CAAC,KAAD,EAAQ,SAAR,CAHsB;AAIjCG,MAAAA,yBAAyB,EAAE;AAJM,KAA7B,CAAN,CALwC,CAWxC;;AACA,WAAON,MAAM,CAACO,UAAd,CAZwC,CAaxC;;AACA,WAAOP,MAAM,CAACQ,UAAd;AACD,GAfM,MAeA,IAAIT,OAAO,CAACE,IAAR,KAAiB,QAArB,EAA+B;AACpCD,IAAAA,MAAM,GAAG,oCAAcS,mBAAd,EAAyBX,WAAzB,EAAsC;AAC7CY,MAAAA,yBAAyB,EAAE,IADkB;AAE7CC,MAAAA,cAAc,EAAE;AAF6B,KAAtC,CAAT;AAID,GALM,MAKA,IAAIZ,OAAO,CAACE,IAAZ,EAAkB;AACvB,UAAM,KAAIW,uBAAJ,EACH,0BAAyBb,OAAO,CAACE,IAAK,uCADnC,CAAN;AAGD,GAJM,MAIA;AACLD,IAAAA,MAAM,GAAG,oCAAcS,mBAAd,EAAyBX,WAAzB,EAAsC;AAC7CY,MAAAA,yBAAyB,EAAE;AADkB,KAAtC,CAAT;AAGD;;AAED,QAAMG,YAAY,GAAGd,OAAO,CAACe,IAAR,GAAed,MAAf,GAAwBA,MAAM,CAACI,GAApD;;AAEA,MAAI,CAACL,OAAO,CAACgB,IAAb,EAAmB;AACjBC,mBAAIC,GAAJ;;AACA,4CAAUJ,YAAV;;AACAG,mBAAIC,GAAJ;AACD,GAJD,MAIO;AACLD,mBAAIE,MAAJ,CAAWC,IAAI,CAACC,SAAL,CAAeP,YAAf,CAAX;AACD;AACF","sourcesContent":["import { getConfig, ProjectConfig } from '@expo/config';\nimport { compileModsAsync } from '@expo/config-plugins/build/plugins/mod-compiler';\nimport { getPrebuildConfigAsync } from '@expo/prebuild-config';\n\nimport CommandError from '../../../CommandError';\nimport Log from '../../../log';\nimport { logConfig } from '../../eject/configureProjectAsync';\nimport { profileMethod } from '../../utils/profileMethod';\n\ntype Options = {\n  type?: string;\n  full: boolean;\n  json?: boolean;\n};\n\nexport async function actionAsync(projectRoot: string, options: Options) {\n  let config: ProjectConfig;\n\n  if (options.type === 'prebuild') {\n    config = await profileMethod(getPrebuildConfigAsync)(projectRoot, {\n      platforms: ['ios', 'android'],\n    });\n  } else if (options.type === 'introspect') {\n    config = await profileMethod(getPrebuildConfigAsync)(projectRoot, {\n      platforms: ['ios', 'android'],\n    });\n\n    await compileModsAsync(config.exp, {\n      projectRoot,\n      introspect: true,\n      platforms: ['ios', 'android'],\n      assertMissingModProviders: false,\n    });\n    // @ts-ignore\n    delete config.modRequest;\n    // @ts-ignore\n    delete config.modResults;\n  } else if (options.type === 'public') {\n    config = profileMethod(getConfig)(projectRoot, {\n      skipSDKVersionRequirement: true,\n      isPublicConfig: true,\n    });\n  } else if (options.type) {\n    throw new CommandError(\n      `Invalid option: --type ${options.type}. Valid options are: public, prebuild`\n    );\n  } else {\n    config = profileMethod(getConfig)(projectRoot, {\n      skipSDKVersionRequirement: true,\n    });\n  }\n\n  const configOutput = options.full ? config : config.exp;\n\n  if (!options.json) {\n    Log.log();\n    logConfig(configOutput);\n    Log.log();\n  } else {\n    Log.nested(JSON.stringify(configOutput));\n  }\n}\n"],"file":"configAsync.js"}