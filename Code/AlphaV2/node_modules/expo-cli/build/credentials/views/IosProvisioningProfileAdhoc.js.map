{"version":3,"sources":["../../../src/credentials/views/IosProvisioningProfileAdhoc.ts"],"names":["CreateOrReuseProvisioningProfileAdhoc","constructor","app","options","distCertSerialNumber","udids","assignProvisioningProfile","ctx","provisioningProfile","ios","updateProvisioningProfile","Log","log","chalk","green","provisioningProfileId","accountName","projectName","bundleIdentifier","createOrReuse","ensureAppleCtx","ppManager","ProvisioningProfileAdhocManager","appleCtx","open","user","Error"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;AASO,MAAMA,qCAAN,CAA6D;AAIlEC,EAAAA,WAAW,CAASC,GAAT,EAA+BC,OAA/B,EAAyE;AAAA,SAAhED,GAAgE,GAAhEA,GAAgE;;AAAA;;AAAA;;AAClF,UAAM;AAAEE,MAAAA,oBAAF;AAAwBC,MAAAA;AAAxB,QAAkCF,OAAxC;AACA,SAAKC,oBAAL,GAA4BA,oBAA5B;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;AAE8B,QAAzBC,yBAAyB,CAACC,GAAD,EAAeC,mBAAf,EAAyD;AACtF,UAAMD,GAAG,CAACE,GAAJ,CAAQC,yBAAR,CAAkC,KAAKR,GAAvC,EAA4CM,mBAA5C,CAAN;;AACAG,mBAAIC,GAAJ,CACEC,iBAAMC,KAAN,CACG,kDAAiDN,mBAAmB,CAACO,qBAAsB,QAAO,KAAKb,GAAL,CAASc,WAAY,IAAG,KAAKd,GAAL,CAASe,WAAY,KAAI,KAAKf,GAAL,CAASgB,gBAAiB,GADhL,CADF;AAKD;;AAEkB,QAAbC,aAAa,CAACZ,GAAD,EAA6C;AAC9D,UAAMA,GAAG,CAACa,cAAJ,EAAN;AACA,UAAMC,SAAS,GAAG,KAAIC,2DAAJ,EAAoCf,GAAG,CAACgB,QAAxC,CAAlB;AACA,WAAO,MAAMF,SAAS,CAACF,aAAV,CACX,KAAKd,KADM,EAEX,KAAKH,GAAL,CAASgB,gBAFE,EAGX,KAAKd,oBAHM,CAAb;AAKD;;AAES,QAAJoB,IAAI,CAACjB,GAAD,EAAsC;AAC9C,QAAI,CAACA,GAAG,CAACkB,IAAT,EAAe;AACb,YAAM,IAAIC,KAAJ,CAAW,6CAAX,CAAN;AACD;;AAED,UAAMlB,mBAAmB,GAAG,MAAM,KAAKW,aAAL,CAAmBZ,GAAnB,CAAlC;AACA,UAAM,KAAKD,yBAAL,CAA+BC,GAA/B,EAAoCC,mBAApC,CAAN;AACA,WAAO,IAAP;AACD;;AArCiE","sourcesContent":["import chalk from 'chalk';\n\nimport { ProvisioningProfile } from '../../appleApi';\nimport { ProvisioningProfileAdhocManager } from '../../appleApi/provisioningProfileAdhoc';\nimport Log from '../../log';\nimport { AppLookupParams } from '../api/IosApi';\nimport { Context, IView } from '../context';\n\nexport type ProvisioningProfileAdhocOptions = {\n  distCertSerialNumber: string;\n  udids: string[];\n};\n\nexport class CreateOrReuseProvisioningProfileAdhoc implements IView {\n  private distCertSerialNumber: string;\n  private udids: string[];\n\n  constructor(private app: AppLookupParams, options: ProvisioningProfileAdhocOptions) {\n    const { distCertSerialNumber, udids } = options;\n    this.distCertSerialNumber = distCertSerialNumber;\n    this.udids = udids;\n  }\n\n  async assignProvisioningProfile(ctx: Context, provisioningProfile: ProvisioningProfile) {\n    await ctx.ios.updateProvisioningProfile(this.app, provisioningProfile);\n    Log.log(\n      chalk.green(\n        `Successfully assigned Provisioning Profile id: ${provisioningProfile.provisioningProfileId} to @${this.app.accountName}/${this.app.projectName} (${this.app.bundleIdentifier})`\n      )\n    );\n  }\n\n  async createOrReuse(ctx: Context): Promise<ProvisioningProfile> {\n    await ctx.ensureAppleCtx();\n    const ppManager = new ProvisioningProfileAdhocManager(ctx.appleCtx);\n    return await ppManager.createOrReuse(\n      this.udids,\n      this.app.bundleIdentifier,\n      this.distCertSerialNumber\n    );\n  }\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const provisioningProfile = await this.createOrReuse(ctx);\n    await this.assignProvisioningProfile(ctx, provisioningProfile);\n    return null;\n  }\n}\n"],"file":"IosProvisioningProfileAdhoc.js"}