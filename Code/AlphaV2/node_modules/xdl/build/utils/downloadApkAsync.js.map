{"version":3,"sources":["../../src/utils/downloadApkAsync.ts"],"names":["_apkCacheDirectory","dotExpoHomeDirectory","UserSettings","dir","path","join","fs","mkdirpSync","downloadApkAsync","url","downloadProgressCallback","versions","Versions","versionsAsync","androidUrl","filename","parse","name","apkPath","pathExists","undefined"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;AAEA,SAASA,kBAAT,GAA8B;AAC5B,QAAMC,oBAAoB,GAAGC,yBAAaD,oBAAb,EAA7B;;AACA,QAAME,GAAG,GAAGC,gBAAKC,IAAL,CAAUJ,oBAAV,EAAgC,mBAAhC,CAAZ;;AACAK,qBAAGC,UAAH,CAAcJ,GAAd;;AACA,SAAOA,GAAP;AACD;;AAEM,eAAeK,gBAAf,CACLC,GADK,EAELC,wBAFK,EAGL;AACA,MAAI,CAACD,GAAL,EAAU;AACR,UAAME,QAAQ,GAAG,MAAMC,qBAASC,aAAT,EAAvB;AACAJ,IAAAA,GAAG,GAAGE,QAAQ,CAACG,UAAf;AACD;;AAED,QAAMC,QAAQ,GAAGX,gBAAKY,KAAL,CAAWP,GAAX,EAAgBQ,IAAjC;;AACA,QAAMC,OAAO,GAAGd,gBAAKC,IAAL,CAAUL,kBAAkB,EAA5B,EAAiC,GAAEe,QAAS,MAA5C,CAAhB;;AAEA,MAAI,MAAMT,mBAAGa,UAAH,CAAcD,OAAd,CAAV,EAAkC;AAChC,WAAOA,OAAP;AACD;;AAED,QAAM,kCAAiBT,GAAjB,EAAsBS,OAAtB,EAA+BE,SAA/B,EAA0CV,wBAA1C,CAAN;AACA,SAAOQ,OAAP;AACD","sourcesContent":["import fs from 'fs-extra';\nimport path from 'path';\n\nimport { downloadAppAsync, UserSettings, Versions } from '../internal';\n\nfunction _apkCacheDirectory() {\n  const dotExpoHomeDirectory = UserSettings.dotExpoHomeDirectory();\n  const dir = path.join(dotExpoHomeDirectory, 'android-apk-cache');\n  fs.mkdirpSync(dir);\n  return dir;\n}\n\nexport async function downloadApkAsync(\n  url?: string,\n  downloadProgressCallback?: (roundedProgress: number) => void\n) {\n  if (!url) {\n    const versions = await Versions.versionsAsync();\n    url = versions.androidUrl;\n  }\n\n  const filename = path.parse(url).name;\n  const apkPath = path.join(_apkCacheDirectory(), `${filename}.apk`);\n\n  if (await fs.pathExists(apkPath)) {\n    return apkPath;\n  }\n\n  await downloadAppAsync(url, apkPath, undefined, downloadProgressCallback);\n  return apkPath;\n}\n"],"file":"downloadApkAsync.js"}